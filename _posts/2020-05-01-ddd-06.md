---
layout: post
title: DDD 06  (TWIL)
categories: [DDD]
tags: [DDD]
---

# 도메인 이벤트와 전술적 설계 

## 도메인 이벤트
 - 비즈니스 관점에서 중요한 사항들에 대한 기록
 - 인과관계 일관성와 선형 시스템 아키텍처
 - 전술적 설계는 도메인 이벤트를 도메인 모델에 구체화한다
 - 바운디드 컨텍스트와 기타 자원들은 이 도메인 이벤트를 받아서 활용한다

## 도메인 이벤트를 설게, 구현, 사용하기

### 설계 시 주의 사항
 - 과거형 동사로 네이밍한다
 - 도메인 이벤트를 실행시키는 명령은 현재형 동사로 네이밍 한다
 - 도메인 이벤트에 그 의미를 잃ㅇ르 정도로 너무 많은 데이터를 가득 채우는 일이 없도록 주의

### 구현하기
 - 명령은 해당 애그리게잇에서 실행되고 이벤트를 발생시킨다
 - 수정된 애그리게잇과 도메인 이벤트는 같은 트랜잭션에서 함께 저장된다
 - 도메인 이벤트를 인과관계의 순서에 따라 저장하는 것이 같은 요청 내에 분산되어 있는 다른 노드들에 도달할 것을 보장하는 것은 아니다
      - 적절한 인과관계를 파악하는 것 또한 이를 소비하는 바운드디 컨택스트가 가져야할 책임
 - 명령이 아닌 것(사실이나 다른 도메인 이벤트)으로 인해서 도메인 이벤트가 생성될 수도 있다 
      - ex: 기간 만료

### 사용하기
 - 명령은 가용성이나 비즈니스 사유등으로 거부 할수 있다
 - 도메인 이벤트는 논리적으로 부정할 수 없다
     - 도메인 이벤트에 대한 응답을 위해 명령을 생성할 수도 있다

## 이벤트 소싱

### 이벤트 소싱
 - 발생했던 모든 도메인 이벤트를 저장
 - 모든 도메인 이벤트를 발생한 순서대로 이벤트 스크림에 구성
 - command query resoponsbility segregation

### 이벤트 레파지토리
 - 모든 도메인 이벤트를 추가하는 순차적인 리파지토리 컬렉션이나 테이블
 - 이벤트 스토어: 오직 추가만 가능. 빠른 속도. 핵심 도메인에 사용 가능

