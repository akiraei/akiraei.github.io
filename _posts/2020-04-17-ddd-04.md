---
layout: post
title: DDD 04  (TWIL)
categories: [DDD]
tags: [DDD]
---

# 컨텍스트 매핑과 전략적 설계

## 컨텍스트 매핑
 - 핵심 도메인을 다른 바운디드 컨텍스트와 통합하는 것
 - 각각의 컨택스트는 각각의 보편언어를 가지고 있음. 컨택스트 매핑의 중간은 통역의 역할을 함

## 매핑의 종류

### 파트너십
 - 각 팀은 각각의 바운디드 컨택스트를 책임진다
 - 의존성을 맞추기 위해서 파트너십을 구성

### 공유커널
 - 작지만 공통의 모듈을 공유함
     - 공유하는 모델 요소에 대해 서로 합의함
 - 공유하는 모델의 코드, 빌드를 관리/테스트 하는 것은 한 팀이 주도함
 - 지속적인 합의가 필요: 처리/관리가 어려움

### 고객-공급자
 - 요구: 고객
 - 언제받는가, 무엇을 받는가: 공급자가 결정
 - 관계를 주도하는 것은 공급자
 - 일반적이고 현실적인 관계

### 준수자
 - 하류팀이 상류팀의 보편언어를 수용/준수함

### 반부패계층
 - 상류팀과 하류팀 사이에 번역 계층을 만듬
 - 외부의 이질적임 개념으로 부터 독립성을 유지할 수도 있음
 - 비용이 높아질 가능성이 있음

### 공개 호스트 서비스
 - 접근을 제공하는 프로토콜이나 인터페이스를 정의
 - 흔히 말하는 API

### 공표된 언어
 - 잘 문서화된 정보 교환 언어
 - json, xml, yaml

### 각자의 길
 - 1개 이상의 바운디드 컨텍스트를 통합
 - 다양한 보편언어를 사용하는 것이 유의미한 결과를 제공하지 못하는 상황
 - 바운디드 컨택스트 내에서 이를 위한 해결 방안을 만들것 
    - 통합은 잊어버리자

### 큰 진흙 덩어리
 - 기를 쓰고 피하자
 - 1개 이상의 큰 진흙 덩어리와 반드시 통합해야 한다
    - 각 레거시 시스템에 대응한 반부패 계층을 만들어서 여러분의 모델을 보호해야 한다
    - 무슨 일이 있어도 그 언어를 섞어서 쓰면 안된다

## 컨택스트 매핑 활용과 종류
 
### warning
 - 다양한 인터페이스가 있지만 데이터베이스 통합은 진짜 패하자
 - 반드시 반부패계층을 사용해 여러분의 모델을 독립 시켜야 한다

### SOAP를 이용한 RPC
 - rpc: remote procedure calls
 - soap: simple object access protocal
 - 마치 단순히 로컬 프로시저나 메서드를 호출하는 것처럼 사용
 - 강한 결합을 암시
 - 견고함이 떨어질 수 있음
    - 사용하기 쉬워 보인다고 해서 속으면 안 된다

### restful http
 - post, get, put, delete 네가지 주요 오퍼레이션이 관여됨
 - 분산 컴퓨팅에 적합한 api들을 정의하는데 도움을 주기 때문
 - 서비스 바운디드 컨텍스트: 공개 호스트 서비스 + 공표된 언어를 제공해야 함
 - 도메인 모델 안에 직접적으로 애그리게잇을 반영하는 리소스를 설계하는 실수가 흔하다
     - 모델 변화가 리소스의 형태에 영향을 줄 수 있다.
     - 리소스가 클라이언트 주도의 유스케이스를 지원할 수 있도록 종합적으로 설계해야한다

### messaging
 - 비동기 메시징
 - 발행된 도메인 이벤트를 구독하는 클라이언트: 가장 견고한 형태중 하나
     - 분절된 형태와의 일시적인 결합을 대부분 제거할 수 있기 때문
 - 소비자들은 이벤트 발행자의 이벤트 형태(ex: class)를 사용하면 안된다. 오직 이벤트의 스키마, 즉 공표된 언어(ex: xml, json)에만 의존해야 한다.
 - 지연 발생을 감내할 수만 있다면, 메시징으로 설계하는 것은 전체 솔루션을 처음부터 매우 견고하게 만들 수 있다는 것을 의미	





## 컨택스트 매핑 활용 사례

##
